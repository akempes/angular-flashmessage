angular.module("flashMessage",["ng"]).provider("flashMessage",[function(){"use strict";var a={viewChange:["$routeChangeSuccess"],persist:0,delay:0,wrapperTemplate:"flashMessage/wrapper.html",template:"flashMessage/message.html",showClose:!0,clickToClose:!0},b=[{type:"success",delay:3e3},{type:"error"},{type:"warning"},{type:"info"}];this.setType=function(a,c,d,e,f,g){if(!/^[a-zA-Z0-9]+$/.test(a))return void console.log("The message type `"+a+"` is not valid, use only alphanumeric characters.");var h=b.map(function(a){return a.type}).indexOf(a),i={type:a,persist:c,delay:d,template:e,showClose:f,clickToClose:g};h<0?b.push(i):b[h]=i},this.setConfig=function(b){a=angular.extend(a,b)},this.$get=["$q","$interval","$rootScope",function(c,d,e){var f={},g=function(a){var b;for(b=0;b<a.length;b+=1)if(void 0!==a[b])return a[b]},h=function(a){angular.forEach(f.messages,function(b){b.persist_counter+=a,b.persist>0&&b.persist_counter<=0&&b.close("viewChanged")})};return f.messages=[],f.getConfig=function(){return a},angular.forEach(b,function(h){f[h.type]=function(i,j,k,l,m,n){var o,p=b.map(function(a){return a.type}).indexOf(h.type);return p<0?void console.log("Type not defined."):(o={type:h.type,data:i,defer:c.defer(),persist:g([j,b[p].persist,a.persist,0]),persist_counter:g([j,b[p].persist,a.persist,0]),delay:g([k,b[p].delay,a.delay,0]),template:g([m,b[p].template,a.template,0]),clickToClose:g([n,b[p].clickToClose,a.clickToClose,0]),showClose:g([l,b[p].showClose,a.showClose,0]),close:function(a){if("clickToClose"!==a||o.clickToClose){var b=f.messages.map(function(a){return a.$$hashKey}).indexOf(o.$$hashKey);f.messages.splice(b,1),d.cancel(f.timeout),o.defer.resolve({result:a,msg:o})}}},o.delay&&o.delay>0&&(o.timeout=d(function(){o.close("timedout")},o.delay)),f.messages.push(o),e.$broadcast("new-flash-message",o),o.defer.promise)}}),angular.forEach(a.viewChange,function(a){e.$on(a,function(){h(-1)})}),f}]}]).directive("flashMessage",["flashMessage",function(a){"use strict";var b={scope:{types:"@flashMessage"},templateUrl:function(b,c){return c.flashMessageTemplate||a.getConfig().wrapperTemplate},link:function(b){b.types&&(b.types=b.types.split(",")),b.messages=a.messages,b.restrictTypes=function(a){return""===b.types||b.types.indexOf(a.type)>-1}}};return b}]).filter("allowHtmlInMessage",["$sce",function(a){"use strict";return function(b){return a.trustAsHtml(b)}}]).run(["$templateCache",function(a){"use strict";a.put("flashMessage/wrapper.html",'<ul class="flash-message-wrapper"><li ng-repeat="msg in messages | filter:restrictTypes" ng-include="msg.template" ng-click="msg.close(\'clickToClose\')" class="flash-message-item flash-message-{{msg.type}}" ng-class="{\'flash-message-clickable\': msg.clickToClose}"></li></ul>'),a.put("flashMessage/message.html",'<span class="flash-message-body" ng-bind-html="msg.data | allowHtmlInMessage"></span><span class="flash-message-close flash-message-clickable" ng-if="msg.showClose" ng-click="msg.close(\'close\')">&times;</span>')}]);